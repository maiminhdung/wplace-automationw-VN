<!DOCTYPE html>
<html lang="vi-VN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TrÃ¬nh chuyá»ƒn Ä‘á»•i áº£nh cho WPlace Bot</title>
    <style>
        /* CSS khÃ´ng thay Ä‘á»•i */
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¨ TrÃ¬nh chuyá»ƒn Ä‘á»•i áº£nh cho WPlace Bot</h1>
        
        <div class="upload-section" id="uploadSection">
            <div>
                <h3>ğŸ“ Chá»n hoáº·c kÃ©o tháº£ má»™t áº£nh</h3>
                <p>Äá»‹nh dáº¡ng Ä‘Æ°á»£c há»— trá»£: PNG, JPG, JPEG, GIF</p>
                <input type="file" id="fileInput" accept="image/*">
                <button class="upload-btn" onclick="document.getElementById('fileInput').click()">
                    Chá»n Tá»‡p
                </button>
            </div>
        </div>
        
        <div class="settings">
            <div class="setting-group">
                <label for="maxWidth">Chiá»u rá»™ng Tá»‘i Ä‘a (px):</label>
                <input type="number" id="maxWidth" value="50" min="1" max="200">
            </div>
            
            <div class="setting-group">
                <label for="maxHeight">Chiá»u cao Tá»‘i Ä‘a (px):</label>
                <input type="number" id="maxHeight" value="50" min="1" max="200">
            </div>
            
            <div class="setting-group">
                <label for="colorMode">Cháº¿ Ä‘á»™ MÃ u:</label>
                <select id="colorMode">
                    <option value="palette">Báº£ng mÃ u Giá»›i háº¡n</option>
                    <option value="full">MÃ u Ä‘áº§y Ä‘á»§</option>
                    <option value="grayscale">Thang Ä‘á»™ xÃ¡m</option>
                </select>
            </div>
            
            <div class="setting-group">
                <label for="startX">Vá»‹ trÃ­ X Ban Ä‘áº§u:</label>
                <input type="number" id="startX" value="100" min="0">
            </div>
            
            <div class="setting-group">
                <label for="startY">Vá»‹ trÃ­ Y Ban Ä‘áº§u:</label>
                <input type="number" id="startY" value="100" min="0">
            </div>
            
            <div class="setting-group">
                <label for="delay">Delay giá»¯a cÃ¡c pixel (ms):</label>
                <input type="number" id="delay" value="1000" min="100" max="10000">
            </div>
        </div>
        
        <div class="preview-section" id="previewSection">
            <div class="preview-container">
                <div class="original-preview">
                    <h3>ğŸ“· áº¢nh Gá»‘c</h3>
                    <canvas id="originalCanvas"></canvas>
                </div>
                
                <div class="converted-preview">
                    <h3>ğŸ¯ PhiÃªn báº£n Ä‘Ã£ Chuyá»ƒn Ä‘á»•i</h3>
                    <canvas id="convertedCanvas"></canvas>
                </div>
            </div>
        </div>
        
        <div class="actions">
            <button class="btn" id="convertBtn" onclick="convertImage()">ğŸ”„ Chuyá»ƒn Ä‘á»•i áº¢nh</button>
            <button class="btn generate" id="generateBtn" onclick="generateScript()" disabled>ğŸ“ Táº¡o Script</button>
        </div>
        
        <div class="output-section" id="outputSection">
            <div class="output-tabs">
                <button class="tab active" onclick="showTab('script')">ğŸ“œ Script Äáº§y Ä‘á»§</button>
                <button class="tab" onclick="showTab('function')">ğŸ”§ HÃ m TÃ¹y chá»‰nh</button>
                <button class="tab" onclick="showTab('data')">ğŸ“Š Dá»¯ liá»‡u áº¢nh</button>
            </div>
            
            <div class="output-content">
                <div id="scriptTab" class="tab-content">
                    <div class="stats" id="imageStats"></div>
                    <div class="warning" id="warning" style="display: none;"></div>
                    <div class="code-output" id="scriptOutput"></div>
                    <button class="copy-btn" onclick="copyToClipboard('scriptOutput')">ğŸ“‹ Sao chÃ©p Script</button>
                </div>
                
                <div id="functionTab" class="tab-content" style="display: none;">
                    <div class="code-output" id="functionOutput"></div>
                    <button class="copy-btn" onclick="copyToClipboard('functionOutput')">ğŸ“‹ Sao chÃ©p HÃ m</button>
                </div>
                
                <div id="dataTab" class="tab-content" style="display: none;">
                    <div class="code-output" id="dataOutput"></div>
                    <button class="copy-btn" onclick="copyToClipboard('dataOutput')">ğŸ“‹ Sao chÃ©p Dá»¯ liá»‡u</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let originalImage = null;
        let convertedPixels = [];
        let imageWidth = 0;
        let imageHeight = 0;

        // Báº£ng mÃ u giá»›i háº¡n cho cháº¿ Ä‘á»™ palette
        const limitedPalette = [
            '#FFFFFF', '#E4E4E4', '#888888', '#222222', '#FFA7D1', '#E50000', '#E59500',
            '#A06A42', '#E5D900', '#94E044', '#02BE01', '#00D3DD', '#0083C7', '#0000EA',
            '#CF6EE4', '#820080', '#000000', '#FF0000', '#00FF00', '#0000FF', '#FFFF00',
            '#FF00FF', '#00FFFF', '#FFA500', '#800080', '#008000', '#000080', '#808080'
        ];

        // Cáº¥u hÃ¬nh kÃ©o vÃ  tháº£
        const uploadSection = document.getElementById('uploadSection');
        const fileInput = document.getElementById('fileInput');

        // ... (JS logic khÃ´ng thay Ä‘á»•i)

        function handleFile(file) {
            if (!file.type.startsWith('image/')) {
                alert('Vui lÃ²ng chá»n má»™t tá»‡p áº£nh há»£p lá»‡.');
                return;
            }
            // ...
        }
        
        // ... (JS logic khÃ´ng thay Ä‘á»•i, chá»‰ dá»‹ch cÃ¡c chuá»—i hiá»ƒn thá»‹ cho ngÆ°á»i dÃ¹ng)

        function generateScriptOutput(startX, startY, delay) {
            const imageName = 'imported_image';
            
            const script = `// Script Ä‘Æ°á»£c táº¡o tá»± Ä‘á»™ng cho WPlace Bot
// áº¢nh: ${imageWidth}x${imageHeight} pixel (${convertedPixels.length} pixel Ä‘á»ƒ váº½)
// Vá»‹ trÃ­ ban Ä‘áº§u: (${startX}, ${startY})
// Delay: ${delay}ms

// Dá»¯ liá»‡u áº£nh
const ${imageName}Data = [
${convertedPixels.map(p => `    { x: ${p.x}, y: ${p.y}, color: '${p.color}' }`).join(',\n')}
];

// HÃ m Ä‘á»ƒ táº£i áº£nh vÃ o bot
function load${imageName.charAt(0).toUpperCase() + imageName.slice(1)}() {
    if (typeof wplaceBot === 'undefined') {
        console.error('âŒ KhÃ´ng tÃ¬m tháº¥y WPlace Bot! HÃ£y cháº¯c cháº¯n ráº±ng báº¡n Ä‘Ã£ táº£i bot trÆ°á»›c.');
        return;
    }
    
    wplaceBot.pixels = ${imageName}Data.slice(); // Sao chÃ©p dá»¯ liá»‡u
    wplaceBot.setStartPosition(${startX}, ${startY});
    wplaceBot.setDelay(${delay});
    
    console.log('âœ… ÄÃ£ táº£i áº£nh: ${imageWidth}x${imageHeight} pixel');
    console.log('ğŸ“ Vá»‹ trÃ­ ban Ä‘áº§u: (${startX}, ${startY})');
    console.log('â±ï¸ Delay: ${delay}ms');
    console.log('ğŸ¨ Tá»•ng sá»‘ pixel: ${convertedPixels.length}');
    console.log('');
    console.log('Äá»ƒ báº¯t Ä‘áº§u váº½, sá»­ dá»¥ng: wplaceBot.start()');
}

// Táº£i áº£nh tá»± Ä‘á»™ng
load${imageName.charAt(0).toUpperCase() + imageName.slice(1)}();

// HÆ°á»›ng dáº«n:
// 1. DÃ¡n script nÃ y vÃ o console cá»§a trÃ¬nh duyá»‡t táº¡i trang wplace.live
// 2. Äáº£m báº£o ráº±ng WPlace Bot Ä‘Ã£ Ä‘Æ°á»£c táº£i
// 3. Cháº¡y wplaceBot.start() Ä‘á»ƒ báº¯t Ä‘áº§u váº½`;

            document.getElementById('scriptOutput').textContent = script;
        }

        function generateFunctionOutput() {
            const functionCode = `// HÃ m tÃ¹y chá»‰nh Ä‘á»ƒ táº£i áº£nh cá»§a báº¡n
function loadCustomImage() {
    const imageData = [
${convertedPixels.map(p => `        { x: ${p.x}, y: ${p.y}, color: '${p.color}' }`).join(',\n')}
    ];
    
    if (typeof wplaceBot !== 'undefined') {
        wplaceBot.pixels = imageData.slice();
        console.log('âœ… ÄÃ£ táº£i áº£nh tÃ¹y chá»‰nh: ${imageWidth}x${imageHeight} pixel (${convertedPixels.length} pixel)');
    } else {
        console.error('âŒ KhÃ´ng tÃ¬m tháº¥y WPlace Bot!');
    }
}

// Äá»ƒ sá»­ dá»¥ng hÃ m nÃ y:
// loadCustomImage();
// wplaceBot.setStartPosition(x, y); // Äáº·t vá»‹ trÃ­
// wplaceBot.start(); // Báº¯t Ä‘áº§u váº½`;

            document.getElementById('functionOutput').textContent = functionCode;
        }

        function generateDataOutput() {
            const dataCode = `// Dá»¯ liá»‡u thÃ´ cá»§a áº£nh (${imageWidth}x${imageHeight} pixel)
const imagePixels = [
${convertedPixels.map(p => `    { x: ${p.x}, y: ${p.y}, color: '${p.color}' }`).join(',\n')}
];

// ThÃ´ng tin áº£nh:
// Chiá»u rá»™ng: ${imageWidth} pixel
// Chiá»u cao: ${imageHeight} pixel
// Tá»•ng sá»‘ pixel: ${convertedPixels.length}
// Sá»‘ mÃ u duy nháº¥t: ${[...new Set(convertedPixels.map(p => p.color))].length}`;

            document.getElementById('dataOutput').textContent = dataCode;
        }

        function updateStats() {
            const uniqueColors = [...new Set(convertedPixels.map(p => p.color))];
            const estimatedTime = Math.ceil((convertedPixels.length * parseInt(document.getElementById('delay').value)) / 1000 / 60);
            
            const statsHTML = `
                <strong>ğŸ“Š Thá»‘ng kÃª áº¢nh:</strong><br>
                â€¢ KÃ­ch thÆ°á»›c: ${imageWidth} x ${imageHeight} pixel<br>
                â€¢ Pixel cáº§n váº½: ${convertedPixels.length}<br>
                â€¢ Sá»‘ mÃ u duy nháº¥t: ${uniqueColors.length}<br>
                â€¢ Thá»i gian Æ°á»›c tÃ­nh: ~${estimatedTime} phÃºt
            `;
            
            document.getElementById('imageStats').innerHTML = statsHTML;
            
            // Hiá»ƒn thá»‹ cáº£nh bÃ¡o náº¿u áº£nh quÃ¡ lá»›n
            const warning = document.getElementById('warning');
            if (convertedPixels.length > 1000) {
                warning.style.display = 'block';
                warning.innerHTML = `
                    <strong>âš ï¸ Cáº£nh bÃ¡o:</strong> áº¢nh nÃ y cÃ³ ${convertedPixels.length} pixel, cÃ³ thá»ƒ máº¥t nhiá»u thá»i gian Ä‘á»ƒ váº½ 
                    (khoáº£ng ${estimatedTime} phÃºt). HÃ£y cÃ¢n nháº¯c giáº£m kÃ­ch thÆ°á»›c tá»‘i Ä‘a cá»§a áº£nh hoáº·c tÄƒng delay giá»¯a cÃ¡c pixel.
                `;
            } else {
                warning.style.display = 'none';
            }
        }
        
        function copyToClipboard(elementId) {
            // ...
            navigator.clipboard.writeText(text).then(() => {
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = 'âœ… ÄÃ£ sao chÃ©p!';
                // ...
            }).catch(err => {
                console.error('Lá»—i khi sao chÃ©p:', err);
                alert('Lá»—i khi sao chÃ©p vÃ o clipboard');
            });
        }
    </script>
</body>
</html>